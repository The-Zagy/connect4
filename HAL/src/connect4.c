#include "../tm4c123gh6pm.h"
#include "../LIBRARIES/common/Std_Types.h"
#include "../LIBRARIES/CpuDriver/inc/cpu_driver.h"
#include "../MCAL/INTERRUPT/inc/IntCtrl.h"
#include "../inc/connect4.h"
#include "../../Nokia5110.h"
#include "../../Random.h"
#include "../../TExaS.h"
#include "../MCAL/PORT/Inc/Port_Cfg.h"
#include <math.h>
#include <time.h>
#include <string.h>
#include <stdlib.h>
#define ROWS_NUM 6
#define COLS_NUM 7

int move_right_flag = 0;
int move_left_flag = 0;
int action_flag = 0;
int timer_flag = 0;

int col = 0, row = 0;
int valid_moves[7];
int num_valid_moves = 0;
int random_move_index;

const unsigned char logo[] = {
    0x42,
    0x4D,
    0x7A,
    0x2E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x36,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0x53,
    0x00,
    0x00,
    0x00,
    0x2F,
    0x00,
    0x00,
    0x00,
    0x01,
    0x00,
    0x18,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x44,
    0x2E,
    0x00,
    0x00,
    0xC3,
    0x0E,
    0x00,
    0x00,
    0xC3,
    0x0E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x0C,
    0x0C,
    0x00,
    0x8D,
    0x8D,
    0x00,
    0x85,
    0x85,
    0x00,
    0xA1,
    0xA1,
    0x00,
    0x87,
    0x87,
    0x00,
    0x23,
    0x23,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x1F,
    0x1F,
    0x00,
    0xCD,
    0xCD,
    0x00,
    0x33,
    0x33,
    0x00,
    0x78,
    0x78,
    0x00,
    0x91,
    0x91,
    0x00,
    0x0C,
    0x0C,
    0x00,
    0x9B,
    0x9B,
    0x00,
    0x2F,
    0x2F,
    0x00,
    0x62,
    0x62,
    0x00,
    0xE4,
    0xE4,
    0x00,
    0x17,
    0x17,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0xA7,
    0xA7,
    0x00,
    0x93,
    0x93,
    0x00,
    0xFF,

};

const unsigned char empty_cell[] = {
    0x42,
    0x4D,
    0xA6,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x76,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0x0C,
    0x00,
    0x00,
    0x00,
    0x06,
    0x00,
    0x00,
    0x00,
    0x01,
    0x00,
    0x04,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x30,
    0x00,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x80,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x80,
    0x00,
    0x80,
    0x80,
    0x00,
    0x00,
    0x80,
    0x80,
    0x80,
    0x00,
    0xC0,
    0xC0,
    0xC0,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x00,
    0xA0,
    0x00,
    0x00,
    0x00,
    0x00,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0x00,
    0x00,
    0x00,
    0x00,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0x00,
    0x00,
    0x00,
    0x00,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0x00,
    0x00,
    0x00,
    0x00,
    0x0A,
    0x00,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x00,
    0xFF,

};

const unsigned char full_cell_player_1[] = {
    0x42,
    0x4D,
    0xA6,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x76,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0x0C,
    0x00,
    0x00,
    0x00,
    0x06,
    0x00,
    0x00,
    0x00,
    0x01,
    0x00,
    0x04,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x30,
    0x00,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x80,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x80,
    0x00,
    0x80,
    0x80,
    0x00,
    0x00,
    0x80,
    0x80,
    0x80,
    0x00,
    0xC0,
    0xC0,
    0xC0,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x00,
    0xAA,
    0x0A,
    0x0A,
    0x0A,
    0x0A,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0xA0,
    0xA0,
    0xA0,
    0xA0,
    0xAA,
    0x00,
    0x00,
    0xAA,
    0x0A,
    0x0A,
    0x0A,
    0x0A,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0xA0,
    0xA0,
    0xA0,
    0xA0,
    0xAA,
    0x00,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x00,
    0xFF,

};

const unsigned char full_cell_player_2[] = {
    0x42,
    0x4D,
    0xA6,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x76,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0x0C,
    0x00,
    0x00,
    0x00,
    0x06,
    0x00,
    0x00,
    0x00,
    0x01,
    0x00,
    0x04,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x30,
    0x00,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x80,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x80,
    0x00,
    0x80,
    0x80,
    0x00,
    0x00,
    0x80,
    0x80,
    0x80,
    0x00,
    0xC0,
    0xC0,
    0xC0,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x00,
    0xAA,
    0x00,
    0xA0,
    0x0A,
    0x00,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0xA0,
    0x0A,
    0x00,
    0xA0,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0x0A,
    0x00,
    0xA0,
    0x0A,
    0x0A,
    0x00,
    0x00,
    0xA0,
    0x00,
    0xA0,
    0x0A,
    0x00,
    0xAA,
    0x00,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x00,
    0xFF,

};

const unsigned char arrow[] = {
    0x42,
    0x4D,
    0x9E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x76,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0x08,
    0x00,
    0x00,
    0x00,
    0x0A,
    0x00,
    0x00,
    0x00,
    0x01,
    0x00,
    0x04,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x80,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x80,
    0x00,
    0x80,
    0x80,
    0x00,
    0x00,
    0x80,
    0x80,
    0x80,
    0x00,
    0xC0,
    0xC0,
    0xC0,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0x00,
    0xAA,
    0xAA,
    0x00,
    0x0A,
    0xAA,
    0xAA,
    0xA0,
    0xAA,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0x00,
    0x0A,
    0xA0,
    0x00,
    0xFF,

};

const unsigned char logo1[] = {
    0x42,
    0x4D,
    0x4A,
    0x04,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x76,
    0x00,
    0x00,
    0x00,
    0x28,
    0x00,
    0x00,
    0x00,
    0x38,
    0x00,
    0x00,
    0x00,
    0x23,
    0x00,
    0x00,
    0x00,
    0x01,
    0x00,
    0x04,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0xD4,
    0x03,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0xC4,
    0x0E,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x80,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x80,
    0x00,
    0x80,
    0x00,
    0x80,
    0x80,
    0x00,
    0x00,
    0x80,
    0x80,
    0x80,
    0x00,
    0xC0,
    0xC0,
    0xC0,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x80,
    0x00,
    0x00,
    0x07,
    0x77,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x80,
    0x00,
    0x00,
    0x08,
    0xF8,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x80,
    0x00,
    0x00,
    0x88,
    0x88,
    0x88,
    0x00,
    0x03,
    0x00,
    0x00,
    0x08,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x88,
    0x88,
    0x00,
    0x88,
    0x88,
    0x8F,
    0x00,
    0x8F,
    0xF7,
    0x00,
    0x0F,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x88,
    0x88,
    0x80,
    0x78,
    0x88,
    0xFF,
    0x07,
    0xFF,
    0xFF,
    0x00,
    0x08,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x88,
    0x88,
    0x80,
    0x07,
    0x8F,
    0xF0,
    0x07,
    0xF8,
    0x7F,
    0x00,
    0x88,
    0x80,
    0x00,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0xF7,
    0x0F,
    0x00,
    0x88,
    0x30,
    0x88,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0xF7,
    0x08,
    0x00,
    0x88,
    0x88,
    0x8F,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x88,
    0x00,
    0x00,
    0x00,
    0x07,
    0x88,
    0x70,
    0x0F,
    0xF0,
    0x08,
    0x08,
    0x80,
    0x0F,
    0x87,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x88,
    0x80,
    0x00,
    0x00,
    0x78,
    0x88,
    0x88,
    0x0F,
    0xF0,
    0x0F,
    0x08,
    0x80,
    0x07,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x88,
    0x88,
    0x88,
    0x00,
    0xFF,
    0x88,
    0x8F,
    0x00,
    0x00,
    0x08,
    0x08,
    0x80,
    0x07,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x88,
    0x88,
    0x00,
    0x88,
    0x88,
    0xF8,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x7F,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x88,
    0x88,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x77,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x07,
    0x28,
    0x87,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x80,
    0x07,
    0x07,
    0x70,
    0x08,
    0x70,
    0x7F,
    0x8F,
    0x70,
    0x07,
    0x78,
    0x00,
    0x00,
    0x06,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x78,
    0x88,
    0x88,
    0xF8,
    0x70,
    0x00,
    0x00,
    0x00,
    0x08,
    0x80,
    0x08,
    0x07,
    0x80,
    0x88,
    0x70,
    0x7F,
    0x87,
    0x70,
    0x88,
    0x88,
    0x80,
    0x00,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x07,
    0xFF,
    0xFF,
    0x77,
    0x78,
    0x70,
    0x00,
    0x88,
    0x73,
    0x0F,
    0x80,
    0x88,
    0x07,
    0x70,
    0x88,
    0x70,
    0x78,
    0x00,
    0x08,
    0xF8,
    0x77,
    0x80,
    0x00,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x07,
    0xF8,
    0x87,
    0x00,
    0x07,
    0x70,
    0x08,
    0x88,
    0x88,
    0x08,
    0x88,
    0x88,
    0x07,
    0x78,
    0x88,
    0x70,
    0x7F,
    0x88,
    0x08,
    0xF7,
    0x00,
    0x00,
    0x00,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x77,
    0x88,
    0x87,
    0x00,
    0x00,
    0x70,
    0x88,
    0x88,
    0x88,
    0x08,
    0x88,
    0x88,
    0x07,
    0x88,
    0x87,
    0x70,
    0x7F,
    0xF8,
    0x08,
    0xF7,
    0x00,
    0x00,
    0x00,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x68,
    0x88,
    0x70,
    0x00,
    0x00,
    0x00,
    0x88,
    0x88,
    0x88,
    0x08,
    0x88,
    0x88,
    0x07,
    0x88,
    0x00,
    0x70,
    0x88,
    0x70,
    0x08,
    0xF7,
    0x00,
    0x20,
    0x00,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x00,
    0x68,
    0x88,
    0x70,
    0x00,
    0x00,
    0x00,
    0x08,
    0x88,
    0x87,
    0x08,
    0x88,
    0x08,
    0x08,
    0x87,
    0x00,
    0x80,
    0xF8,
    0x77,
    0x08,
    0xF7,
    0x33,
    0x00,
    0x08,
    0xF8,
    0x70,
    0x00,
    0x00,
    0x00,
    0x68,
    0x88,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0xF8,
    0x00,
    0x08,
    0x80,
    0x08,
    0x07,
    0xF7,
    0x03,
    0x80,
    0x7F,
    0x88,
    0x00,
    0xFF,
    0x78,
    0x00,
    0x8F,
    0xFF,
    0xF8,
    0x00,
    0x00,
    0x00,
    0x78,
    0x88,
    0x80,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0x00,
    0x08,
    0x00,
    0x80,
    0x00,
    0x00,
    0x8F,
    0xFF,
    0x70,
    0x8F,
    0xFF,
    0x00,
    0xFF,
    0x88,
    0xF7,
    0x00,
    0x00,
    0x00,
    0x08,
    0x8F,
    0xF7,
    0x00,
    0x06,
    0x70,
    0x00,
    0x08,
    0x70,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x07,
    0xFF,
    0xF7,
    0x00,
    0x07,
    0x70,
    0x78,
    0x8F,
    0x87,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x07,
    0xFF,
    0x8E,
    0x70,
    0x68,
    0x00,
    0x78,
    0x88,
    0x88,
    0x30,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x0F,
    0x8E,
    0x88,
    0xF8,
    0x00,
    0x78,
    0x88,
    0x88,
    0x30,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x07,
    0x78,
    0x87,
    0x70,
    0x00,
    0x7F,
    0x88,
    0x8F,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x08,
    0xFF,
    0x84,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0xFF,

};

// Draw the arrow indicator for the current column
void draw_arrow_indicator(enum Cols_name current_col)
{
  int x = current_col * CELL_WIDTH + 3;
  int y = 10;
  Nokia5110_ClearBuffer();
  Nokia5110_DisplayBuffer();
  Nokia5110_PrintBMP(x, y, arrow, 0);
  Nokia5110_DisplayBuffer();
}

void draw_board_with_indicator(position_state_t board[ROWS_NUM][COLS_NUM], enum Cols_name current_col, enum Game_state game_state)
{

  // Draw the board as usual
  draw_board(board, current_col, game_state);

  // Draw the arrow indicator
  draw_arrow_indicator(current_col);
}

void Timer2_Init(unsigned long period)
{
  unsigned long volatile delay;
  SYSCTL_RCGCTIMER_R |= 0x04; // 0) activate timer2
  delay = SYSCTL_RCGCTIMER_R;
  timer_flag = 0;
  TIMER2_CTL_R = 0x00000000;                             // 1) disable timer2A during setup
  TIMER2_CFG_R = 0x00000000;                             // 2) configure for 32-bit mode
  TIMER2_TAMR_R = 0x00000002;                            // 3) configure for periodic mode, default down-count settings
  TIMER2_TAILR_R = period - 1;                           // 4) reload value
  TIMER2_TAPR_R = 0;                                     // 5) bus clock resolution
  TIMER2_ICR_R = 0x00000001;                             // 6) clear timer2A timeout flag
  TIMER2_IMR_R = 0x00000001;                             // 7) arm timeout interrupt
  NVIC_PRI5_R = (NVIC_PRI5_R & 0x00FFFFFF) | 0x80000000; // 8) priority 4
                                                         // interrupts enabled in the main program after all devices initialized
                                                         // vector number 39, interrupt number
  NVIC_EN0_R = 1 << 23;                                  // 9) enable IRQ 23 in NVIC
  TIMER2_CTL_R = 0x00000001;                             // 10) enable timer2A
}

void Timer2A_Handler(void)
{
  TIMER2_ICR_R = 0x00000001; // acknowledge timer2A timeout
  timer_flag += 1;
}

void stop_timer(void)
{
  TIMER2_CTL_R = 0x00000000; // 1) disable timer2A during setup
}

void game_Init(void)
{
  Timer2_Init(80000000);
  // int mode;
  Port_Init(&Move_Right_Button);
  Port_Init(&Move_Left_Button);
  Port_Init(&Action_Button);

  Port_EXTI_Init(&EXTI_Right_Button);
  Port_EXTI_Init(&EXTI_Left_Button);
  Port_EXTI_Init(&EXTI_Action_Button);

  IntCrtl_Init(&Int_Right_Button);
  IntCrtl_Init(&Int_Left_Button);
  IntCrtl_Init(&Int_Action_Button);
  Nokia5110_Clear();
  cpuDriver_EnableGlobalInterrupt();
}

void starting_screen(void)
{
  Nokia5110_ClearBuffer();
  Nokia5110_PrintBMP(10, 35, logo1, 2);
  Nokia5110_DisplayBuffer();
  Nokia5110_SetCursor(0, 5);
  Nokia5110_OutString("Welcome :D!");
  while (timer_flag != 1)
    ;
  stop_timer();
}

void select_mode(game_mode_t mode)
{ // here is selecting if the mode is P1 VS AI or P1 vs P2

  Nokia5110_SetCursor(0, 0);
  Nokia5110_OutString("select");
  Nokia5110_SetCursor(7, 0);
  Nokia5110_OutString("mode");
  Nokia5110_SetCursor(3, 2);
  Nokia5110_OutString("P1 VS AI");
  Nokia5110_SetCursor(3, 4);
  Nokia5110_OutString("P1 VS P2");
  Nokia5110_SetCursor(0, (mode * 2) + 2);
  Nokia5110_OutString(">>");
}

/**
 * insert new position state in certian column, and row number is managed by gravity [first empty row in this column], the row_num state from which row start searching for correct position in recursive
 * return TRUE if inserted successfully
 */
bool_t insert_token(position_state_t board[ROWS_NUM][COLS_NUM], position_state_t state, enum Cols_name col_num, unsigned row_num)
{
  // don't go out of scope
  if (col_num >= COLS_NUM || col_num < 0 || row_num >= ROWS_NUM || row_num < 0)
  {
    return FALSE_t;
  }
  // can't insert in full column
  // go down the rows until you find empty row and the one before it is full or you reached the floor

  // reached non empty field means no free space in this column
  if (board[row_num][col_num] != EMPTY)
  {
    return FALSE_t;
  }

  // empty then non-empty or ground is the one satisfy the gravity
  if (board[row_num][col_num] == EMPTY && (board[row_num + 1][col_num] != EMPTY || row_num == ROWS_NUM - 1))
  {
    board[row_num][col_num] = state;
    return TRUE_t;
  }
  else
  {
    return insert_token(board, state, col_num, row_num + 1);
  }
  return FALSE_t;
}

int ai_player(position_state_t board[ROWS_NUM][COLS_NUM])
{
  // Evaluate the current state of the board and make a decision
  // You can modify this part to implement your desired AI algorithm

  // Check for a winning move
  for (col = 0; col < COLS_NUM; col++)
  {
    for (row = 0; row < ROWS_NUM; row++)
    {
      if (board[row][col] == 0)
      {
        // Check horizontally
        if (col < COLS_NUM - 3 && board[row][col + 1] == board[row][col + 2] == board[row][col + 3] && board[row][col + 1] != 0)
        {
          return col;
        }
        // Check vertically
        if (row < ROWS_NUM - 3 && board[row + 1][col] == board[row + 2][col] == board[row + 3][col] && board[row + 1][col] != 0)
        {
          return col;
        }
        // Check diagonally (ascending)
        if (col < COLS_NUM - 3 && row > 2 && board[row - 1][col + 1] == board[row - 2][col + 2] == board[row - 3][col + 3] && board[row - 1][col + 1] != 0)
        {
          return col;
        }
        // Check diagonally (descending)
        if (col < COLS_NUM - 3 && row < ROWS_NUM - 3 && board[row + 1][col + 1] == board[row + 2][col + 2] == board[row + 3][col + 3] && board[row + 1][col + 1] != 0)
        {
          return col;
        }
      }
    }
  }

  // If no winning move is found, make a random valid move
  // int valid_moves[COLS_NUM];
  // int num_valid_moves = 0;

  // Find valid moves
  for (col = 0; col < COLS_NUM; col++)
  {
    if (board[ROWS_NUM - 1][col] == EMPTY)
    {
      valid_moves[num_valid_moves] = col;
      num_valid_moves++;
    }
  }

  // Choose a random valid move
  random_move_index = rand() % num_valid_moves;
  return valid_moves[random_move_index];
}

bool_t check_for_winner(position_state_t board[ROWS_NUM][COLS_NUM], position_state_t piece)
{
  int c;
  int r;
  // Check horizontal locations for win
  for (c = 0; c < COLS_NUM - 3; c++)
  {
    for (r = 0; r < ROWS_NUM; r++)
    {
      if (board[r][c] == piece && board[r][c + 1] == piece && board[r][c + 2] == piece && board[r][c + 3] == piece)
      {
        return TRUE_t;
      }
    }
  }

  // Check vertical locations for win
  for (c = 0; c < COLS_NUM; c++)
  {
    for (r = 0; r < ROWS_NUM - 3; r++)
    {
      if (board[r][c] == piece && board[r + 1][c] == piece && board[r + 2][c] == piece && board[r + 3][c] == piece)
      {
        return TRUE_t;
      }
    }
  }

  // Check positively sloped diagonals
  for (c = 0; c < COLS_NUM - 3; c++)
  {
    for (r = 0; r < ROWS_NUM - 3; r++)
    {
      if (board[r][c] == piece && board[r + 1][c + 1] == piece && board[r + 2][c + 2] == piece && board[r + 3][c + 3] == piece)
      {
        return TRUE_t;
      }
    }
  }

  // Check negatively sloped diagonals
  for (c = 0; c < COLS_NUM - 3; c++)
  {
    for (r = 3; r < ROWS_NUM; r++)
    {
      if (board[r][c] == piece && board[r - 1][c + 1] == piece && board[r - 2][c + 2] == piece && board[r - 3][c + 3] == piece)
      {
        return TRUE_t;
      }
    }
  }

  return FALSE_t;
}
void draw_board(position_state_t board[ROWS_NUM][COLS_NUM], enum Cols_name arrow_position, enum Game_state game_state)
{
  int offsetY = 17;
  int i, j;
  Nokia5110_PrintBMP(arrow_position * CELL_WIDTH + 3, 10, arrow, 0);
  Nokia5110_SetCursor(arrow_position * CELL_WIDTH + 6, 10);

  for (i = 0; i < ROWS_NUM; i++)
  {
    for (j = 0; j < COLS_NUM; j++)
    {
      int x = j * CELL_WIDTH;
      int y = i * CELL_HEIGHT + offsetY;
      if (board[i][j] == EMPTY)
      {
        Nokia5110_PrintBMP(x, y, empty_cell, 0);
      }
      else if (board[i][j] == PLAYER1_SLOT)
      {
        Nokia5110_PrintBMP(x, y, full_cell_player_1, 0);
      }
      else if (board[i][j] == PLAYER2_SLOT)
      {
        Nokia5110_PrintBMP(x, y, full_cell_player_2, 0);
      }
    }
  }
  Nokia5110_DisplayBuffer();
  if (game_state == GAME_PLAYER1_TURN)
  {
    Nokia5110_OutString("P1");
  }
  else
  {
    Nokia5110_OutString("P2");
  }
}

void Delay100ms(unsigned long count)
{
  unsigned long volatile time;
  while (count)
  {
    time = 72724; // 0.1sec at 80 MHz
    while (time)
    {
      time--;
    }
    count--;
  }
}

void endScreen(game_state_t state)
{
  Nokia5110_Clear();
  if (state == GAME_END_TIE)
  {
    Nokia5110_SetCursor(1, 1);
    Nokia5110_OutString("It's a tie!");
  }
  if (state == GAME_PLAYER1_WON)
  {
    Nokia5110_SetCursor(1, 1);
    Nokia5110_OutString("Player 1 ");
    Nokia5110_SetCursor(1, 2);
    Nokia5110_OutString("Won!");
  }
  if (state == GAME_PLAYER2_WON)
  {
    Nokia5110_SetCursor(1, 1);
    Nokia5110_OutString("Player 2 ");
    Nokia5110_SetCursor(1, 2);
    Nokia5110_OutString("Won!");
  }
  Nokia5110_SetCursor(1, 4);
  Nokia5110_OutString("GAME OVER");
  Delay100ms(200);
}